<config-template xmlns="http://tail-f.com/ns/config/1.0"
                 servicepoint="mdt">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>{/device}</name>
      <config>
        <telemetry xmlns="urn:ios">
          <ietf>
            <subscription>
              <id>{/sub_id}</id>
              <encoding>encode-kvgpb</encoding>
              <filter>
                <xpath>{/xpath}</xpath>
              </filter>
              <source-address>{/xe_src_addr}</source-address>
              <stream>yang-push</stream>
              <update-policy>
                <periodic>{/sample}</periodic>
              </update-policy>
              <receiver>
                <ip>
                  <address>
                    <address>{/rx_ip}</address>
                    <port>{/rx_port}</port>
                    <protocol>grpc-tcp</protocol>
                  </address>
                </ip>
              </receiver>
            </subscription>
          </ietf>
        </telemetry>
        <telemetry xmlns="http://tail-f.com/ned/cisco-ios-xr">
          <model-driven>
            <destination-group>
              <id>{/sub_id}</id>
              <address-family>
                <ipv4>
                  <address>{/rx_ip}</address>
                  <port>{/rx_port}</port>
                  <encoding>self-describing-gpb</encoding>
                  <protocol>
                    <grpc>
                      <no-tls/>
                    </grpc>
                  </protocol>
                </ipv4>
              </address-family>
            </destination-group>
            <sensor-group>
              <id>{/sub_id}</id>
              <sensor-path>
                <name>{/xpath}</name>
              </sensor-path>
            </sensor-group>
            <subscription>
              <id>{/sub_id}</id>
              <source-interface>
                <Loopback>0</Loopback>
              </source-interface>
              <sensor-group-id>
                <name>{/sub_id}</name>
                <sample-interval>{/sample}0</sample-interval>
              </sensor-group-id>
              <destination-id>
                <name>{/sub_id}</name>
              </destination-id>
            </subscription>
          </model-driven>
        </telemetry>
      </config>
    </device>
  </devices>
</config-template>
